const b=(r,i)=>{if(!r||r.length===0){alert("No data to export.");return}const c=Object.keys(r[0]),o=[c.join(","),...r.map(a=>c.map(p=>{const e=a[p];return typeof e=="string"?`"${e.replace(/"/g,'""')}"`:e}).join(","))].join(`
`),s=new Blob([o],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(s),t=document.createElement("a");t.setAttribute("href",l),t.setAttribute("download",`${i}_${new Date().toISOString().split("T")[0]}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)},m=r=>new Promise((i,c)=>{const o=new FileReader;o.onload=s=>{const l=s.target?.result;if(!l)return i([]);const t=l.split(`
`),a=t[0].split(",").map(e=>e.trim().replace(/"/g,"")),p=[];for(let e=1;e<t.length;e++){if(!t[e].trim())continue;const h=t[e].split(","),u={};for(let d=0;d<a.length;d++){let n=h[d]?.trim();n&&n.startsWith('"')&&n.endsWith('"')&&(n=n.substring(1,n.length-1).replace(/""/g,'"')),u[a[d]]=n}p.push(u)}i(p)},o.onerror=s=>c(s),o.readAsText(r)});export{b as e,m as p};
