import{u as b,r as l,j as e}from"./index.Cgn8UqAd.js";import{T as g}from"./Table.qlFSYBMu.js";import{M as F}from"./Modal.Dm3XWcYn.js";import{e as O}from"./csvHelper.D2kXyc6K.js";import"./index.Cjd9_PBs.js";const P=["All Roles","Admin","SEO","Content","Developer","SMM","Manager","QC"],U=["All Departments","Management","Marketing","Content","Technology","Quality"],q=()=>{const{data:f}=b("users"),{data:j,create:v,update:N,remove:y}=b("roles"),[r,x]=l.useState("users"),[o,u]=l.useState(""),[c,w]=l.useState("All Roles"),[d,R]=l.useState("All Departments"),[C,n]=l.useState(!1),[i,m]=l.useState(null),[t,a]=l.useState({role_name:"",status:"Active",permissions:{read:!0,write:!1,delete:!1}}),h=f.filter(s=>{const _=s.name.toLowerCase().includes(o.toLowerCase())||s.email.toLowerCase().includes(o.toLowerCase()),L=c==="All Roles"||s.role===c,T=d==="All Departments"||s.department===d;return _&&L&&T}),p=j.filter(s=>s.role_name.toLowerCase().includes(o.toLowerCase())),k=()=>{O(r==="users"?h:p,`${r}_export`)},S=async()=>{i?await N(i.id,t):await v(t),n(!1),m(null),a({role_name:"",status:"Active",permissions:{read:!0,write:!1,delete:!1}})},A=async s=>{confirm("Delete this role?")&&await y(s)},D=s=>{m(s),a(s),n(!0)},E=[{header:"Name",accessor:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold mr-3",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.name,className:"h-full w-full rounded-full object-cover"}):s.name.charAt(0)}),e.jsx("span",{className:"font-medium text-slate-900",children:s.name})]})},{header:"Role",accessor:"role"},{header:"Department",accessor:"department"},{header:"Email",accessor:"email",className:"text-slate-500"},{header:"Country",accessor:"country"},{header:"Target",accessor:"target",className:"font-mono text-green-600"},{header:"Projects",accessor:s=>e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-50 text-blue-700 font-bold text-xs",children:s.projects_count}),className:"text-center"},{header:"Status",accessor:s=>e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${s.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status==="active"?"Active":"Inactive"})},{header:"Last Login",accessor:"last_login",className:"text-xs text-slate-500"}],M=[{header:"Role Name",accessor:"role_name",className:"font-bold"},{header:"Status",accessor:"status"},{header:"Permissions",accessor:s=>e.jsxs("div",{className:"flex gap-2 text-xs",children:[s.permissions?.read&&e.jsx("span",{className:"bg-blue-50 text-blue-600 px-2 rounded",children:"Read"}),s.permissions?.write&&e.jsx("span",{className:"bg-green-50 text-green-600 px-2 rounded",children:"Write"}),s.permissions?.delete&&e.jsx("span",{className:"bg-red-50 text-red-600 px-2 rounded",children:"Delete"})]})},{header:"Actions",accessor:s=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>D(s),className:"text-blue-600 text-xs font-bold",children:"Edit"}),e.jsx("button",{onClick:()=>A(s.id),className:"text-red-600 text-xs font-bold",children:"Del"})]})}];return e.jsxs("div",{className:"space-y-6 h-full overflow-y-auto w-full pr-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:"User & Role Master"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage users, roles, permissions and departmental assignments"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:k,className:"text-slate-600 hover:text-indigo-600 bg-white border border-slate-300 px-4 py-2 rounded-lg text-sm font-medium shadow-sm transition-colors",children:"Export"}),r==="roles"&&e.jsx("button",{onClick:()=>{m(null),a({role_name:"",status:"Active",permissions:{read:!0,write:!1,delete:!1}}),n(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-bold shadow-sm",children:"+ Add Role"})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>x("users"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Users"}),e.jsx("button",{onClick:()=>x("roles"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="roles"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Roles & Permissions"})]})}),r==="users"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[e.jsx("input",{type:"search",className:"block w-full p-2.5 border border-gray-300 rounded-lg",placeholder:"Search users...",value:o,onChange:s=>u(s.target.value)}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("select",{value:c,onChange:s=>w(s.target.value),className:"bg-slate-50 border border-slate-300 text-sm rounded-lg p-2.5",children:P.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("select",{value:d,onChange:s=>R(s.target.value),className:"bg-slate-50 border border-slate-300 text-sm rounded-lg p-2.5",children:U.map(s=>e.jsx("option",{value:s,children:s},s))})]})]})}),e.jsx(g,{columns:E,data:h,title:"User Registry"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-4",children:e.jsx("input",{type:"search",className:"block w-full p-2.5 border border-gray-300 rounded-lg",placeholder:"Search roles...",value:o,onChange:s=>u(s.target.value)})}),e.jsx(g,{columns:M,data:p,title:"System Roles"})]}),e.jsx(F,{isOpen:C,onClose:()=>n(!1),title:i?"Edit Role":"Create Role",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role Name"}),e.jsx("input",{type:"text",value:t.role_name,onChange:s=>a({...t,role_name:s.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permissions"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.permissions?.read,onChange:s=>a({...t,permissions:{...t.permissions,read:s.target.checked}}),className:"mr-2"})," Read"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.permissions?.write,onChange:s=>a({...t,permissions:{...t.permissions,write:s.target.checked}}),className:"mr-2"})," Write"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.permissions?.delete,onChange:s=>a({...t,permissions:{...t.permissions,delete:s.target.checked}}),className:"mr-2"})," Delete"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{value:t.status,onChange:s=>a({...t,status:s.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",children:[e.jsx("option",{children:"Active"}),e.jsx("option",{children:"Inactive"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{onClick:S,className:"bg-blue-600 text-white px-4 py-2 rounded-md",children:"Save"})})]})})]})};export{q as default};
