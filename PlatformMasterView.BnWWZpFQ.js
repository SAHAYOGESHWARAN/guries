import{r,A as x,j as e,R as P}from"./index.Cgn8UqAd.js";import{c as C,X as k,P as I,a as A,T as z}from"./x.BiCs_uOD.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],D=C("chevron-down",E);function M({platform:d,contentTypes:b,assetTypes:u,onSave:j,onClose:g}){const[l,o]=r.useState({platform_name:"",platform_code:"",description:"",contentTypeIds:[],assetTypeIds:[],recommendedSizes:[],schedulingOptions:[{type:"Manual",enabled:!1},{type:"Auto",enabled:!1},{type:"Both",enabled:!1}]}),[c,N]=r.useState("basic");r.useEffect(()=>{d&&h()},[d]);const h=async()=>{try{const a=await(await fetch(`${x}/platform-master/${d.id}`)).json();o({platform_name:a.platform_name,platform_code:a.platform_code||"",description:a.description||"",contentTypeIds:a.contentTypes.map(t=>t.id),assetTypeIds:a.assetTypes.map(t=>t.id),recommendedSizes:a.recommendedSizes,schedulingOptions:a.schedulingOptions})}catch(s){console.error("Error fetching platform details:",s)}},i=s=>{const{name:a,value:t}=s.target;o(n=>({...n,[a]:t}))},y=s=>{o(a=>({...a,contentTypeIds:a.contentTypeIds.includes(s)?a.contentTypeIds.filter(t=>t!==s):[...a.contentTypeIds,s]}))},f=s=>{o(a=>({...a,assetTypeIds:a.assetTypeIds.includes(s)?a.assetTypeIds.filter(t=>t!==s):[...a.assetTypeIds,s]}))},v=s=>{o(a=>({...a,schedulingOptions:a.schedulingOptions.map(t=>t.type===s?{...t,enabled:!t.enabled}:t)}))},m=(s,a,t)=>{o(n=>({...n,recommendedSizes:n.recommendedSizes.map((p,_)=>_===s?{...p,[a]:t}:p)}))},w=()=>{o(s=>({...s,recommendedSizes:[...s.recommendedSizes,{asset_type_id:0,recommended_dimension:"",file_format:"",notes:""}]}))},T=s=>{o(a=>({...a,recommendedSizes:a.recommendedSizes.filter((t,n)=>n!==s)}))},S=s=>{if(s.preventDefault(),!l.platform_name.trim()){alert("Platform name is required");return}j(l)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:d?"Edit Platform":"Add New Platform"}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700",children:e.jsx(k,{size:24})})]}),e.jsx("div",{className:"flex border-b px-6 pt-4",children:["basic","content","assets","sizes","scheduling"].map(s=>e.jsx("button",{onClick:()=>N(s),className:`px-4 py-2 font-medium text-sm border-b-2 ${c===s?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsxs("form",{onSubmit:S,className:"p-6",children:[c==="basic"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Platform Name *"}),e.jsx("input",{type:"text",name:"platform_name",value:l.platform_name,onChange:i,placeholder:"e.g., Facebook, Instagram, LinkedIn",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Platform Code"}),e.jsx("input",{type:"text",name:"platform_code",value:l.platform_code,onChange:i,placeholder:"e.g., FB, IG, LI",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:l.description,onChange:i,placeholder:"Platform description and details",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c==="content"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Select Content Types Allowed"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:b.map(s=>e.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.contentTypeIds.includes(s.id),onChange:()=>y(s.id),className:"w-4 h-4 text-blue-600 rounded"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.content_type}),e.jsx("div",{className:"text-xs text-gray-500",children:s.category})]})]},s.id))}),e.jsxs("p",{className:"text-sm text-gray-600 mt-4",children:["Selected: ",l.contentTypeIds.length," content types"]})]}),c==="assets"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Link Asset Type Master"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(s=>e.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.assetTypeIds.includes(s.id),onChange:()=>f(s.id),className:"w-4 h-4 text-blue-600 rounded"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.asset_type}),e.jsx("div",{className:"text-xs text-gray-500",children:s.dimension})]})]},s.id))}),e.jsxs("p",{className:"text-sm text-gray-600 mt-4",children:["Selected: ",l.assetTypeIds.length," asset types"]})]}),c==="sizes"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Recommended Dimensions"}),e.jsx("button",{type:"button",onClick:w,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"+ Add Size"})]}),e.jsx("div",{className:"space-y-4",children:l.recommendedSizes.map((s,a)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asset Type"}),e.jsxs("select",{value:s.asset_type_id,onChange:t=>m(a,"asset_type_id",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Asset Type"}),u.map(t=>e.jsx("option",{value:t.id,children:t.asset_type},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recommended Dimension"}),e.jsx("input",{type:"text",value:s.recommended_dimension,onChange:t=>m(a,"recommended_dimension",t.target.value),placeholder:"e.g., 1200x627px",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File Format"}),e.jsx("input",{type:"text",value:s.file_format,onChange:t=>m(a,"file_format",t.target.value),placeholder:"e.g., JPG, PNG",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("input",{type:"text",value:s.notes,onChange:t=>m(a,"notes",t.target.value),placeholder:"Additional notes",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsx("button",{type:"button",onClick:()=>T(a),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})]},a))})]}),c==="scheduling"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Scheduling Options"}),e.jsx("div",{className:"space-y-3",children:l.schedulingOptions.map(s=>e.jsxs("label",{className:"flex items-center gap-3 p-4 border rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:()=>v(s.type),className:"w-4 h-4 text-blue-600 rounded"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.type}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.type==="Manual"&&"Publish now",s.type==="Auto"&&"Schedule for later",s.type==="Both"&&"Both manual and scheduled"]})]})]},s.type))})]}),e.jsxs("div",{className:"flex gap-3 mt-8 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:g,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700",children:d?"Update Platform":"Add Platform"})]})]})]})})}function R(){const[d,b]=r.useState([]),[u,j]=r.useState([]),[g,l]=r.useState([]),[o,c]=r.useState(!0),[N,h]=r.useState(!1),[i,y]=r.useState(null),[f,v]=r.useState(null);r.useEffect(()=>{m(),w()},[]);const m=async()=>{try{const n=await(await fetch(`${x}/platform-master`)).json();b(n)}catch(t){console.error("Error fetching platforms:",t)}finally{c(!1)}},w=async()=>{try{const[t,n]=await Promise.all([fetch(`${x}/content-types`),fetch(`${x}/asset-types`)]),p=await t.json(),_=await n.json();j(p),l(_)}catch(t){console.error("Error fetching master data:",t)}},T=()=>{y(null),h(!0)},S=t=>{y(t),h(!0)},s=async t=>{if(confirm("Are you sure you want to delete this platform?"))try{await fetch(`${x}/platform-master/${t}`,{method:"DELETE"}),m()}catch(n){console.error("Error deleting platform:",n)}},a=async t=>{try{const n=i?"PUT":"POST",p=i?`${x}/platform-master/${i.id}`:`${x}/platform-master`;await fetch(p,{method:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),h(!1),m()}catch(n){console.error("Error saving platform:",n)}};return o?e.jsx("div",{className:"p-6 text-center",children:"Loading..."}):e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Platform Master"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage platforms, content types, asset types, and scheduling options"})]}),e.jsxs("button",{onClick:T,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[e.jsx(I,{size:20}),"Add Platform"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Platform Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Content Types"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Asset Types"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:d.map(t=>e.jsxs(P.Fragment,{children:[e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:t.platform_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:t.platform_code}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded",children:t.content_type_count})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded",children:t.asset_type_count})}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${t.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v(f===t.id?null:t.id),className:"text-blue-600 hover:text-blue-800",children:e.jsx(D,{size:18})}),e.jsx("button",{onClick:()=>S(t),className:"text-blue-600 hover:text-blue-800",children:e.jsx(A,{size:18})}),e.jsx("button",{onClick:()=>s(t.id),className:"text-red-600 hover:text-red-800",children:e.jsx(z,{size:18})})]})})]}),f===t.id&&e.jsx("tr",{className:"bg-gray-50 border-b",children:e.jsx("td",{colSpan:6,className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-gray-700 mb-2",children:"Description:"}),e.jsx("p",{className:"text-gray-600 mb-4",children:t.description||"No description"})]})})})]},t.id))})]})}),d.length===0&&e.jsx("div",{className:"text-center py-12 bg-white rounded-lg",children:e.jsx("p",{className:"text-gray-500",children:"No platforms found. Create one to get started."})})]}),N&&e.jsx(M,{platform:i,contentTypes:u,assetTypes:g,onSave:a,onClose:()=>h(!1)})]})}const L=()=>e.jsx(R,{});export{L as default};
