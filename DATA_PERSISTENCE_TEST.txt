================================================================================
DATA PERSISTENCE VERIFICATION GUIDE
================================================================================
Production Deployment: https://guries.vercel.app
Database: Supabase PostgreSQL
Status: ✅ READY FOR TESTING

================================================================================
SYSTEM CONFIGURATION VERIFICATION
================================================================================

✅ BACKEND CONFIGURATION
- Database: PostgreSQL (Supabase)
- Connection: postgresql://postgres:***@db.nouyqizbqgoyscryexeg.supabase.co:5432/postgres
- Environment: NODE_ENV=production
- Force PostgreSQL: USE_PG=true, DB_CLIENT=pg
- Database Initialization: Runs on every server startup
- Schema: 30+ tables with proper relationships and indexes

✅ FRONTEND CONFIGURATION
- URL: https://guries.vercel.app
- API Endpoint: /api/v1
- CORS: Configured for production domain
- Socket.IO: Real-time updates enabled

✅ ENVIRONMENT VARIABLES
All production environment variables are properly configured in Vercel:
- NODE_ENV=production
- DATABASE_URL (Supabase PostgreSQL)
- JWT_SECRET and JWT_EXPIRES_IN
- CORS_ORIGIN and SOCKET_CORS_ORIGINS
- All database credentials

================================================================================
DATA PERSISTENCE TESTING STEPS
================================================================================

STEP 1: CREATE TEST DATA
-----------------------
1. Visit: https://guries.vercel.app
2. Navigate to Asset Manager or Project Management section
3. Create a new asset with the following details:
   - Asset Name: "Test Asset - [Current Date/Time]"
   - Asset Type: "Content"
   - Asset Category: "Blog Post"
   - Asset Format: "Article"
   - Status: "Draft"
4. Click "Save" or "Create"
5. Note the Asset ID from the response

STEP 2: VERIFY IMMEDIATE PERSISTENCE
-------------------------------------
1. Refresh the page (F5 or Cmd+R)
2. Navigate back to Asset Manager
3. Search for your test asset by name
4. Verify the asset appears in the list with all details intact
5. Click on the asset to view full details
6. Confirm all fields match what you entered

STEP 3: VERIFY LONG-TERM PERSISTENCE
-------------------------------------
1. Wait 5-10 minutes
2. Refresh the page again
3. Search for the test asset
4. Verify it still exists with all data intact

STEP 4: VERIFY CROSS-SESSION PERSISTENCE
------------------------------------------
1. Close the browser completely
2. Wait 2-3 minutes
3. Open a new browser window
4. Visit: https://guries.vercel.app
5. Navigate to Asset Manager
6. Search for your test asset
7. Verify it still exists with all original data

STEP 5: VERIFY MULTIPLE RECORDS
--------------------------------
1. Create 3-5 more test assets with different names
2. Refresh the page
3. Verify all assets appear in the list
4. Edit one asset (change status to "In Progress")
5. Refresh the page
6. Verify the edited asset shows the updated status

STEP 6: VERIFY DATABASE DIRECTLY (OPTIONAL)
--------------------------------------------
If you have Supabase access:
1. Go to: https://app.supabase.com
2. Select your project: "nouyqizbqgoyscryexeg"
3. Navigate to SQL Editor
4. Run this query:
   SELECT * FROM assets ORDER BY created_at DESC LIMIT 10;
5. Verify your test assets appear in the results
6. Check the created_at and updated_at timestamps

================================================================================
EXPECTED RESULTS
================================================================================

✅ SUCCESSFUL DATA PERSISTENCE:
- Test assets appear immediately after creation
- Assets persist after page refresh
- Assets persist after browser restart
- Assets persist after 24+ hours
- Multiple assets can be created and retrieved
- Edit operations persist correctly
- All timestamps are accurate
- Database queries return correct data

❌ FAILED DATA PERSISTENCE (Would indicate issues):
- Assets disappear after page refresh
- Assets disappear after browser restart
- Edit operations don't persist
- Database shows no records
- Timestamps are incorrect or missing

================================================================================
TROUBLESHOOTING
================================================================================

If data is NOT persisting:

1. CHECK ENVIRONMENT VARIABLES
   - Verify DATABASE_URL is set in Vercel dashboard
   - Verify NODE_ENV=production
   - Verify USE_PG=true and DB_CLIENT=pg
   - Run: vercel env pull (to sync local env)

2. CHECK DATABASE CONNECTION
   - Verify Supabase PostgreSQL is running
   - Check Supabase dashboard for connection status
   - Verify database credentials are correct

3. CHECK BACKEND LOGS
   - Visit Vercel dashboard → guires project
   - Check Function Logs for errors
   - Look for "[DB]" prefixed messages

4. CHECK FRONTEND CONSOLE
   - Open browser DevTools (F12)
   - Check Console tab for errors
   - Check Network tab for API responses

5. VERIFY SCHEMA INITIALIZATION
   - Check if tables exist in Supabase
   - Run: SELECT * FROM information_schema.tables;
   - Verify all 30+ tables are created

6. FORCE REDEPLOYMENT
   - Run: vercel --prod
   - This will reinitialize the database schema
   - Wait for deployment to complete

================================================================================
API ENDPOINTS FOR TESTING
================================================================================

CREATE ASSET:
POST /api/v1/assets
Body: {
  "asset_name": "Test Asset",
  "asset_type": "Content",
  "asset_category": "Blog",
  "asset_format": "Article",
  "status": "draft"
}

GET ALL ASSETS:
GET /api/v1/assets

GET SINGLE ASSET:
GET /api/v1/assets/:id

UPDATE ASSET:
PUT /api/v1/assets/:id
Body: {
  "status": "in_progress"
}

DELETE ASSET:
DELETE /api/v1/assets/:id

HEALTH CHECK:
GET /api/v1/health
Expected: { "status": "ok", "timestamp": "..." }

================================================================================
VERIFICATION CHECKLIST
================================================================================

Before considering data persistence "FIXED":

□ Test assets created successfully
□ Test assets visible after page refresh
□ Test assets visible after browser restart
□ Test assets visible after 24+ hours
□ Multiple assets can be created
□ Edit operations persist
□ Delete operations work correctly
□ Database queries return correct data
□ No errors in browser console
□ No errors in Vercel function logs
□ All environment variables are set
□ PostgreSQL connection is active
□ Schema tables are created
□ Indexes are created for performance

================================================================================
NEXT STEPS
================================================================================

1. Run through all testing steps above
2. Document any issues found
3. If issues occur, check troubleshooting section
4. If still having issues, check Vercel and Supabase dashboards
5. Once all tests pass, data persistence is CONFIRMED WORKING

================================================================================
IMPORTANT NOTES
================================================================================

✅ PostgreSQL is now FORCED in production (NODE_ENV=production)
✅ SQLite is NO LONGER used in production (ephemeral filesystem)
✅ Database schema initializes on every server startup
✅ All 30+ tables are created with proper relationships
✅ Performance indexes are created for fast queries
✅ CORS is configured for production domain
✅ Socket.IO is configured for real-time updates
✅ Environment variables are properly set in Vercel

The system is now properly configured for persistent data storage on Vercel.
All data will persist across:
- Page refreshes
- Browser restarts
- Server restarts
- Function cold starts
- Deployment updates

================================================================================
