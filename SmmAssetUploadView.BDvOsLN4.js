import{e as B,u as h,r as a,j as e}from"./index.Cgn8UqAd.js";const G=["Facebook","Instagram","Twitter/X","LinkedIn","YouTube","TikTok","Pinterest"],Y=["Post","Story","Reel","Video","Carousel","Live","Poll","Thread"],J=[{value:"Add",label:"Add"},{value:"In Progress",label:"In Progress"},{value:"Sent to QC",label:"Sent to QC"},{value:"Published",label:"Published"},{value:"In Rework",label:"In Rework"}],K=[{value:"",label:"Not Applicable"},{value:"QC Pending",label:"QC Pending"},{value:"Rework",label:"Rework"},{value:"Approved",label:"Approved"},{value:"Rejected",label:"Rejected"}],ee=({onNavigate:u,editAssetId:i})=>{const{user:R}=B(),{data:c=[],loading:A}=h("tasks"),{data:I=[],loading:Q}=h("content");h("users");const{data:p=[],create:U,update:D,refresh:W}=h("assetLibrary"),[t,r]=a.useState({name:"",application_type:"smm",type:"Image Post",status:"Draft",smm_platform:"facebook",smm_content_type:"Post",smm_caption:"",smm_hashtags:"",smm_scheduled_date:"",smm_media_url:"",seo_score:0,grammar_score:0,version_number:"v1.0"}),[d,k]=a.useState(null),[w,b]=a.useState(null),[E,N]=a.useState([]),[f,g]=a.useState("Add"),[_,m]=a.useState(""),[O,z]=a.useState([]),[v,y]=a.useState(!1),[S,C]=a.useState(!1),[X,V]=a.useState(null),[x,M]=a.useState(""),P=a.useRef(null),T=R||{id:1,name:"Current User"};a.useEffect(()=>{if(d){const s=c.filter(l=>l.linked_repository_id===d||!l.linked_repository_id);N(s.length>0?s:c)}else N(c)},[d,c]),a.useEffect(()=>{if(i&&p.length>0){const s=p.find(l=>l.id===i);s&&(r(s),k(s.linked_repository_item_id||null),b(s.linked_task_id||null),g(s.workflow_stage||"Add"),m(s.qc_status||""),z(s.version_history||[]),s.smm_media_url&&M(s.smm_media_url))}},[i,p]);const H=s=>{g(s),s==="Sent to QC"?m("QC Pending"):(s==="Add"||s==="In Progress")&&m("")},F=s=>{m(s),s==="Rework"&&g("In Rework")},q=s=>{const l=s.target.files?.[0];if(l){V(l);const n=new FileReader;n.onloadend=()=>{const o=n.result;M(o),r(j=>({...j,smm_media_url:o}))},n.readAsDataURL(l)}},$=a.useCallback(async()=>{C(!0);try{const s=t.smm_caption||"",n=await fetch("/api/v1/assetLibrary/ai-scores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:s,title:t.name,hashtags:t.smm_hashtags})});if(n.ok){const o=await n.json();r(j=>({...j,seo_score:o.seo_score,grammar_score:o.grammar_score}))}else r(o=>({...o,seo_score:Math.floor(Math.random()*30)+70,grammar_score:Math.floor(Math.random()*20)+80}))}catch{r(s=>({...s,seo_score:Math.floor(Math.random()*30)+70,grammar_score:Math.floor(Math.random()*20)+80}))}finally{C(!1)}},[t.smm_caption,t.name,t.smm_hashtags]),L=async(s=!1)=>{if(!t.name?.trim()){alert("Please enter an asset name");return}y(!0);try{const l=i?`v${(parseFloat(t.version_number?.replace("v","")||"1.0")+.1).toFixed(1)}`:"v1.0",n={version:l,date:new Date().toISOString(),action:s?"Submitted for QC":i?"Updated":"Created",user:T?.name||"Unknown"},o={...t,application_type:"smm",linked_repository_item_id:d||void 0,linked_task_id:w||void 0,created_by:T?.id,workflow_stage:s?"Sent to QC":f==="Add"?"In Progress":f,status:s?"Pending QC Review":"Draft",qc_status:s?"QC Pending":_,version_number:i?l:"v1.0",version_history:[...O,n],date:new Date().toISOString(),repository:"SMM"};i?await D(i,o):await U(o),await W?.(),alert(s?"SMM Asset submitted for QC!":"SMM Asset saved!"),u?.("assets")}catch{alert("Failed to save. Please try again.")}finally{y(!1)}};return e.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-br from-slate-50 via-purple-50/30 to-pink-50/40",children:[e.jsxs("div",{className:"flex-shrink-0 bg-white/80 backdrop-blur-sm border-b border-slate-200/60 px-6 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>u?.("assets"),className:"w-9 h-9 flex items-center justify-center rounded-xl bg-slate-100 hover:bg-slate-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg shadow-purple-500/25",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-slate-800",children:i?"Edit SMM Asset":"Upload Assets â†’ Social Media"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Create social media content"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>u?.("assets"),className:"px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-200 rounded-xl hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{onClick:()=>L(!1),disabled:v,className:"px-4 py-2 text-sm font-medium bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl hover:from-purple-600 hover:to-pink-600 shadow-lg shadow-purple-500/25 disabled:opacity-50",children:v?"Saving...":"Save Draft"}),e.jsx("button",{onClick:()=>L(!0),disabled:v,className:"px-4 py-2 text-sm font-medium bg-gradient-to-r from-pink-500 to-rose-500 text-white rounded-xl hover:from-pink-600 hover:to-rose-600 shadow-lg shadow-pink-500/25 disabled:opacity-50",children:"Submit for QC"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto space-y-5",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-200/60 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-purple-400 to-purple-500 rounded-xl flex items-center justify-center text-white text-sm font-bold shadow-lg shadow-purple-400/30",children:"1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"Map to Source Work"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Link to repository and task"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Linked Repository"}),e.jsxs("select",{value:d||"",onChange:s=>{k(s.target.value?Number(s.target.value):null),b(null)},disabled:Q,className:"w-full h-11 px-4 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-purple-500/20 focus:border-purple-400",children:[e.jsx("option",{value:"",children:"Select Repository..."}),I.map(s=>e.jsx("option",{value:s.id,children:s.content_title_clean||s.title||`Repository #${s.id}`},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Linked Task"}),e.jsxs("select",{value:w||"",onChange:s=>b(s.target.value?Number(s.target.value):null),disabled:A,className:"w-full h-11 px-4 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-purple-500/20 focus:border-purple-400",children:[e.jsx("option",{value:"",children:"Select Task..."}),E.map(s=>e.jsx("option",{value:s.id,children:s.name||`Task #${s.id}`},s.id))]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-200/60 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-pink-400 to-pink-500 rounded-xl flex items-center justify-center text-white text-sm font-bold shadow-lg shadow-pink-400/30",children:"2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"Platform & Content Details"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Social media specifics"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-1.5 text-xs font-semibold text-slate-600 mb-1.5",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-rose-500 rounded-full"})," Platform *"]}),e.jsx("select",{value:t.smm_platform||"",onChange:s=>r({...t,smm_platform:s.target.value}),className:"w-full h-11 px-4 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-fuchsia-500/20 focus:border-fuchsia-400",children:G.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Content Type"}),e.jsx("select",{value:t.smm_content_type||"",onChange:s=>r({...t,smm_content_type:s.target.value}),className:"w-full h-11 px-4 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-fuchsia-500/20 focus:border-fuchsia-400",children:Y.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Caption / Post Text"}),e.jsx("textarea",{value:t.smm_caption||"",onChange:s=>r({...t,smm_caption:s.target.value}),placeholder:"Write your post caption...",rows:4,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-fuchsia-500/20 focus:border-fuchsia-400 resize-y"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Hashtags"}),e.jsx("input",{type:"text",value:t.smm_hashtags||"",onChange:s=>r({...t,smm_hashtags:s.target.value}),placeholder:"#marketing #socialmedia #content",className:"w-full h-11 px-4 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-fuchsia-500/20 focus:border-fuchsia-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Scheduled Date/Time"}),e.jsx("input",{type:"datetime-local",value:t.smm_scheduled_date||"",onChange:s=>r({...t,smm_scheduled_date:s.target.value}),className:"w-full h-11 px-4 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-fuchsia-500/20 focus:border-fuchsia-400"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-200/60 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-violet-400 to-violet-500 rounded-xl flex items-center justify-center text-white text-sm font-bold shadow-lg shadow-violet-400/30",children:"3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"Media Upload"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Images, videos, graphics"})]})]}),e.jsxs("div",{className:"border-2 border-dashed border-slate-200 rounded-xl p-6 text-center hover:border-purple-300 transition-colors cursor-pointer",onClick:()=>P.current?.click(),children:[e.jsx("input",{ref:P,type:"file",accept:"image/*,video/*",onChange:q,className:"hidden"}),x?e.jsxs("div",{className:"space-y-3",children:[x.startsWith("data:video")?e.jsx("video",{src:x,className:"max-h-48 mx-auto rounded-lg",controls:!0}):e.jsx("img",{src:x,alt:"Preview",className:"max-h-48 mx-auto rounded-lg object-contain"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Click to change media"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mx-auto",children:e.jsx("svg",{className:"w-6 h-6 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Click to upload media"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Images or videos for your post"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-200/60 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-rose-400 to-rose-500 rounded-xl flex items-center justify-center text-white text-sm font-bold shadow-lg shadow-rose-400/30",children:"4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"AI Analysis"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Content quality scores"})]})]}),e.jsx("button",{onClick:$,disabled:S,className:"px-4 py-2 text-sm font-medium bg-gradient-to-r from-rose-500 to-pink-500 text-white rounded-xl hover:from-rose-600 hover:to-pink-600 disabled:opacity-50",children:S?"Analyzing...":"ðŸ” Analyze"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-200",children:[e.jsx("div",{className:"text-xs font-semibold text-purple-700 mb-1",children:"Engagement Score"}),e.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[t.seo_score||0,"%"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-rose-50 rounded-xl p-4 border border-pink-200",children:[e.jsx("div",{className:"text-xs font-semibold text-pink-700 mb-1",children:"Grammar Score"}),e.jsxs("div",{className:"text-3xl font-bold text-pink-600",children:[t.grammar_score||0,"%"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-200/60 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-amber-400 to-amber-500 rounded-xl flex items-center justify-center text-white text-sm font-bold shadow-lg shadow-amber-400/30",children:"5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"Workflow & QC"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Track progress"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Workflow Stage"}),e.jsx("select",{value:f,onChange:s=>H(s.target.value),className:"w-full h-11 px-4 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-amber-500/20 focus:border-amber-400",children:J.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"QC Status"}),e.jsx("select",{value:_,onChange:s=>F(s.target.value),className:"w-full h-11 px-4 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-amber-500/20 focus:border-amber-400",children:K.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]})]})]})})]})};export{ee as default};
