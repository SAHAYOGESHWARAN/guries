import{u as y,r as o,j as e,g as N}from"./index.Cgn8UqAd.js";import{T as _}from"./Table.qlFSYBMu.js";import{C as i,D as w,B as C}from"./Charts.E4b3PdqH.js";const q=()=>{const{data:s,create:x}=y("qc"),[u,n]=o.useState("list"),[h,c]=o.useState(!1),[r,p]=o.useState(null),[a,d]=o.useState({target_type:"task",target_id:0,qc_status:"under_qc"}),b=s.length>0?Math.round(s.filter(t=>t.qc_status==="approved").length/s.length*100):0,m=Object.entries(s.reduce((t,l)=>(t[l.target_type]=(t[l.target_type]||0)+1,t),{})).map(([t,l],v)=>({id:v,name:t,value:l})),g=async()=>{await x({target_type:a.target_type,target_id:a.target_id,qc_status:"under_qc",qc_owner_id:1,qc_checklist_version_id:1}),n("list")},f=t=>{p({report:{score:t.final_score_percentage||0,summary:t.analysis_report||"No report available."},checklist:[{id:1,title:"Grammar Check",status:"Pass"},{id:2,title:"Tone Consistency",status:"Pass"},{id:3,title:"SEO Compliance",status:"Warn"}]}),c(!0)},j=[{header:"Target Type",accessor:"target_type",className:"uppercase font-bold text-xs text-slate-600"},{header:"ID",accessor:"target_id",className:"font-mono"},{header:"Status",accessor:t=>N(t.qc_status)},{header:"Score",accessor:t=>t.final_score_percentage?`${t.final_score_percentage}%`:"-"},{header:"Actions",accessor:t=>e.jsx("button",{onClick:()=>f(t),className:"text-blue-600 text-xs font-bold hover:underline",children:"View Report"})}];return u==="create"?e.jsxs("div",{className:"h-full flex flex-col bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden animate-fade-in w-full",children:[e.jsxs("div",{className:"border-b border-slate-200 px-8 py-5 flex justify-between items-center bg-slate-50/50",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Initiate QC Run"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>n("list"),className:"px-5 py-2.5 text-sm font-medium text-slate-600 border border-slate-300 rounded-xl hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{onClick:g,className:"bg-blue-600 text-white px-6 py-2.5 rounded-xl font-bold shadow-md hover:bg-blue-700",children:"Add to Queue"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 bg-slate-50",children:e.jsxs("div",{className:"w-full bg-white p-8 rounded-2xl border border-slate-200 shadow-sm space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Target Type"}),e.jsxs("select",{value:a.target_type,onChange:t=>d({...a,target_type:t.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl",children:[e.jsx("option",{value:"task",children:"Task"}),e.jsx("option",{value:"content_asset",children:"Content Asset"}),e.jsx("option",{value:"graphic_asset",children:"Graphic Asset"}),e.jsx("option",{value:"smm_post",children:"SMM Post"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Target ID"}),e.jsx("input",{type:"number",value:a.target_id,onChange:t=>d({...a,target_id:parseInt(t.target.value)}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl",placeholder:"Enter ID of the asset or task..."})]})]})})]}):e.jsxs("div",{className:"space-y-6 h-full overflow-y-auto w-full pr-1 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Intelligent QC Dashboard"}),e.jsx("button",{onClick:()=>n("create"),className:"bg-blue-600 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-700 transition-colors",children:"Start New QC Run"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(i,{title:"Pass Rate",children:e.jsx(w,{value:b,color:"text-green-600",label:"Overall Approval Rate"})}),e.jsx(i,{title:"Reviews by Type",children:e.jsx(C,{data:m,color:"bg-blue-500"})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md flex flex-col justify-center items-center",children:[e.jsx("h3",{className:"text-gray-500 font-bold mb-2",children:"Avg QC Score"}),e.jsxs("p",{className:"text-5xl font-bold text-blue-800",children:[s.filter(t=>t.final_score_percentage).length>0?Math.round(s.reduce((t,l)=>t+(l.final_score_percentage||0),0)/s.filter(t=>t.final_score_percentage).length):"-",e.jsx("span",{className:"text-xl text-gray-400",children:"/100"})]})]})]}),e.jsx(_,{columns:j,data:s,title:"Priority QC Queue"}),h&&r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:()=>c(!1),children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-2xl max-w-2xl w-full mx-4",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"QC Analysis Report"}),e.jsx("button",{onClick:()=>c(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-lg border border-slate-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-bold uppercase",children:"Overall Score"}),e.jsxs("p",{className:"text-4xl font-bold text-blue-600",children:[r.report.score,"/100"]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-700 mb-2",children:"Checklist Coverage"}),e.jsx("ul",{className:"space-y-1 text-sm text-gray-600 border p-3 rounded",children:r.checklist.map(t=>e.jsxs("li",{children:["• ",t.title," - ",e.jsx("span",{className:t.status==="Pass"?"text-green-600 font-bold":"text-orange-600 font-bold",children:t.status})]},t.id))})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded border border-blue-100",children:[e.jsx("h4",{className:"font-bold text-blue-800 text-sm mb-2",children:"Summary"}),e.jsx("p",{className:"text-sm text-blue-900",children:r.report.summary})]})]})]})})]})};export{q as default};
