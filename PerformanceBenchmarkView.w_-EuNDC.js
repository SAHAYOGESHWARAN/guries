import{u as I,r as l,j as e,g as R}from"./index.Cgn8UqAd.js";import{T as Q}from"./Table.qlFSYBMu.js";import{p as P,e as M}from"./csvHelper.D2kXyc6K.js";const $=()=>{const{data:p,create:g,update:j,remove:v}=I("okrs"),[a,m]=l.useState("okr"),[c,y]=l.useState(""),[h,w]=l.useState("All Cycles"),[N,o]=l.useState("list"),[b,n]=l.useState(null),[t,r]=l.useState({objective:"",type:"Department",cycle:"Q1",owner:"",alignment:"",progress:0,status:"Active"}),i=l.useRef(null),f=p.filter(s=>{const d=(s.objective||"").toLowerCase().includes(c.toLowerCase())||(s.owner||"").toLowerCase().includes(c.toLowerCase())||(s.type||"").toLowerCase().includes(c.toLowerCase()),x=h==="All Cycles"||s.cycle===h;return d&&x}),k=Array.from(new Set(p.map(s=>s.cycle))).sort(),C=s=>{n(s),r(s),o("form")},O=async s=>{confirm("Are you sure you want to delete this OKR?")&&await v(s)},L=async()=>{const s={...t,updated_on:"Just now"};b?await j(b.id,s):await g(s),o("list"),n(null),r({objective:"",type:"Department",cycle:"Q1",owner:"",alignment:"",progress:0,status:"Active"})},S=()=>{M(f,"OKR_Master_Export")},K=()=>{i.current?.click()},A=async s=>{if(s.target.files&&s.target.files[0]){try{const d=await P(s.target.files[0]);let x=0;for(const u of d)u.objective&&u.owner&&(await g({...u,progress:parseInt(String(u.progress))||0,updated_on:"Imported"}),x++);alert(`Successfully imported ${x} OKRs.`)}catch{alert("Error parsing CSV file. Please check the format.")}i.current&&(i.current.value="")}},D=[{header:"Objective",accessor:s=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900",children:s.objective}),s.alignment&&e.jsxs("div",{className:"text-xs text-slate-500 mt-0.5",children:["ðŸ”— ",s.alignment]})]}),className:"min-w-[300px]"},{header:"Type",accessor:s=>e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${s.type==="Company"?"bg-purple-100 text-purple-800":s.type==="Department"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700"}`,children:s.type})},{header:"Cycle",accessor:"cycle",className:"font-mono text-xs text-slate-600"},{header:"Owner",accessor:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-[10px] font-bold mr-2",children:s.owner?s.owner.charAt(0):"?"}),e.jsx("span",{className:"text-sm text-slate-700",children:s.owner})]})},{header:"Progress %",accessor:s=>e.jsxs("div",{className:"w-32",children:[e.jsx("div",{className:"flex justify-between text-xs mb-1",children:e.jsxs("span",{className:"font-bold text-slate-700",children:[s.progress||0,"%"]})}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${(s.progress||0)===100?"bg-green-500":(s.progress||0)>60?"bg-blue-500":(s.progress||0)>30?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(s.progress||0,100)}%`}})})]})},{header:"Status",accessor:s=>R(s.status||"")},{header:"Updated On",accessor:"updated_on",className:"text-xs text-slate-500"},{header:"Actions",accessor:s=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>C(s),className:"text-slate-400 hover:text-blue-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>O(s.id),className:"text-slate-400 hover:text-red-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})}];return N==="form"?e.jsxs("div",{className:"h-full flex flex-col bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden animate-fade-in w-full",children:[e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4 flex justify-between items-center bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{o("list"),n(null)},className:"text-slate-400 hover:text-slate-600 transition-colors p-1 rounded-full hover:bg-slate-200",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:b?"Edit OKR":"Define New OKR"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{o("list"),n(null)},className:"px-4 py-2 text-sm font-medium text-slate-600 border border-slate-300 rounded-lg hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{onClick:L,className:"bg-blue-600 text-white px-6 py-2 rounded-lg font-medium shadow-sm hover:bg-blue-700",children:"Save OKR"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 bg-slate-50",children:e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-slate-200 shadow-sm",children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm uppercase mb-4",children:"Objective Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Objective"}),e.jsx("textarea",{value:t.objective,onChange:s=>r({...t,objective:s.target.value}),className:"block w-full border border-gray-300 rounded-lg p-3 h-24 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g. Increase market share by 15% through organic growth"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Level / Type"}),e.jsxs("select",{value:t.type,onChange:s=>r({...t,type:s.target.value}),className:"block w-full border border-gray-300 rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{children:"Company"}),e.jsx("option",{children:"Department"}),e.jsx("option",{children:"Individual"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Cycle"}),e.jsx("input",{type:"text",value:t.cycle,onChange:s=>r({...t,cycle:s.target.value}),className:"block w-full border border-gray-300 rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g. Q1 2025"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-slate-200 shadow-sm",children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm uppercase mb-4",children:"Tracking & Ownership"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner"}),e.jsx("input",{type:"text",value:t.owner,onChange:s=>r({...t,owner:s.target.value}),className:"block w-full border border-gray-300 rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500",placeholder:"Person Responsible"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Progress (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:t.progress,onChange:s=>r({...t,progress:parseInt(s.target.value)}),className:"block w-full border border-gray-300 rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alignment (Parent Goal)"}),e.jsx("input",{type:"text",value:t.alignment,onChange:s=>r({...t,alignment:s.target.value}),className:"block w-full border border-gray-300 rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional: Link to higher level OKR"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:t.status,onChange:s=>r({...t,status:s.target.value}),className:"block w-full border border-gray-300 rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{children:"Active"}),e.jsx("option",{children:"Delayed"}),e.jsx("option",{children:"Completed"}),e.jsx("option",{children:"Draft"})]})]})]})]})})]}):e.jsxs("div",{className:"space-y-6 h-full flex flex-col animate-fade-in w-full",children:[e.jsx("div",{className:"flex justify-between items-start flex-shrink-0",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:"Performance & Benchmark"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage OKRs, KPIs, and performance logs across the organization."})]})}),e.jsx("div",{className:"border-b border-gray-200 flex-shrink-0",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>m("okr"),className:`py-4 px-1 border-b-2 font-medium text-sm ${a==="okr"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"OKR Master"}),e.jsx("button",{onClick:()=>m("kpi"),className:`py-4 px-1 border-b-2 font-medium text-sm ${a==="kpi"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"KPI Master"}),e.jsx("button",{onClick:()=>m("log"),className:`py-4 px-1 border-b-2 font-medium text-sm ${a==="log"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"KPI Log"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col space-y-4 min-h-0",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex flex-col md:flex-row gap-4 items-center justify-between flex-shrink-0",children:[e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 20 20",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})})}),e.jsx("input",{type:"search",className:"block w-full p-2.5 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-slate-50 focus:ring-blue-500 focus:border-blue-500",placeholder:"Search Objective / Owner / Department...",value:c,onChange:s=>y(s.target.value)})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full md:w-auto",children:[e.jsxs("select",{value:h,onChange:s=>w(s.target.value),className:"bg-white border border-slate-300 text-slate-700 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 min-w-[120px]",children:[e.jsx("option",{children:"All Cycles"}),e.jsx("option",{children:"Q1"}),e.jsx("option",{children:"Q2"}),e.jsx("option",{children:"Q3"}),e.jsx("option",{children:"Q4"}),e.jsx("option",{children:"Yearly"}),k.filter(s=>!["Q1","Q2","Q3","Q4","Yearly"].includes(s)).map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("input",{type:"file",ref:i,onChange:A,accept:".csv",style:{display:"none"}}),e.jsx("button",{onClick:K,className:"text-slate-600 hover:text-indigo-600 border border-slate-300 hover:border-indigo-300 bg-white px-3 py-2 rounded-lg transition-colors text-sm flex items-center",children:"Import OKRs"}),e.jsx("button",{onClick:S,className:"text-slate-600 hover:text-indigo-600 border border-slate-300 hover:border-indigo-300 bg-white px-3 py-2 rounded-lg transition-colors text-sm flex items-center",children:"Export"}),e.jsx("button",{onClick:()=>{n(null),r({objective:"",type:"Department",cycle:"Q1",owner:"",alignment:"",progress:0,status:"Active"}),o("form")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium text-sm hover:bg-blue-700 shadow-sm transition-colors flex items-center",children:"+ Create New OKR"})]})]}),e.jsxs("div",{className:"flex-1 overflow-auto border border-slate-200 rounded-xl bg-white shadow-sm",children:[a==="okr"&&e.jsx(Q,{columns:D,data:f,title:""}),a==="kpi"&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:"KPI Master Configuration"}),e.jsx("p",{className:"text-sm",children:"Coming soon..."})]}),a==="log"&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:"KPI Performance Log"}),e.jsx("p",{className:"text-sm",children:"Coming soon..."})]})]})]})]})};export{$ as default};
