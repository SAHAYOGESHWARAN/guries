import{u as d,r as l,j as e,S as b}from"./index.Cgn8UqAd.js";import{T as u}from"./Table.qlFSYBMu.js";import{M as N}from"./Modal.Dm3XWcYn.js";import{r as A}from"./gemini.CcsfAiQp.js";import"./index.Cjd9_PBs.js";const k=()=>{const{data:m,create:p}=d("complianceRules"),{data:x,create:h}=d("complianceAudits"),[r,g]=l.useState("Rules"),[y,i]=l.useState(!1),[a,t]=l.useState({rule_name:"",description:"",severity:"Medium",category:"General"}),[n,c]=l.useState(!1),f=async()=>{await p(a),i(!1),t({rule_name:"",description:"",severity:"Medium",category:"General"})},j=async()=>{c(!0);try{const v=await A('Audit this content snippet against standard compliance rules (GDPR, Brand Safety): "We guarantee results in 2 days or your money back! Call now." Return JSON: { "score": 60, "violations": ["Overpromising", "Aggressive CTA"] }',{model:"gemini-2.5-flash"}),o=JSON.parse(v.text.match(/\{[\s\S]*\}/)?.[0]||"{}");await h({target_type:"Ad Copy",target_id:Math.floor(Math.random()*1e3),score:o.score||0,violations:o.violations||[]}),alert(`Audit Complete. Score: ${o.score}`)}catch{alert("Audit failed")}finally{c(!1)}};return e.jsxs("div",{className:"space-y-6 h-full flex flex-col animate-fade-in w-full",children:[e.jsx("div",{className:"flex justify-between items-start flex-shrink-0",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:"Quality Assurance & Compliance"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Automated governance and rule-based auditing"})]})}),e.jsx("div",{className:"border-b border-slate-200 flex-shrink-0",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:["Rules","Audits"].map(s=>e.jsx("button",{onClick:()=>g(s),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${r===s?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:s},s))})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[r==="Rules"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-blue-700 shadow-sm",children:"+ Add Compliance Rule"})}),e.jsx(u,{columns:[{header:"Rule Name",accessor:"rule_name",className:"font-bold"},{header:"Category",accessor:"category"},{header:"Severity",accessor:s=>e.jsx("span",{className:`font-bold ${s.severity==="High"?"text-red-600":"text-yellow-600"}`,children:s.severity})},{header:"Description",accessor:"description",className:"text-sm text-slate-500"}],data:m,title:"Active Rules"})]}),r==="Audits"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:j,disabled:n,className:"bg-purple-600 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-purple-700 shadow-sm flex items-center disabled:opacity-50",children:[e.jsx(b,{})," ",e.jsx("span",{className:"ml-2",children:n?"Auditing...":"Run Simulation"})]})}),e.jsx(u,{columns:[{header:"Target Type",accessor:"target_type"},{header:"ID",accessor:"target_id",className:"font-mono"},{header:"Score",accessor:s=>e.jsxs("span",{className:`font-bold ${s.score>=80?"text-green-600":"text-red-600"}`,children:[s.score,"/100"]})},{header:"Violations",accessor:s=>s.violations?.join(", ")||"None"},{header:"Date",accessor:s=>new Date(s.audited_at).toLocaleString()}],data:x,title:"Audit Logs"})]})]}),e.jsx(N,{isOpen:y,onClose:()=>i(!1),title:"Add Compliance Rule",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Rule Name",className:"w-full p-2 border rounded",value:a.rule_name,onChange:s=>t({...a,rule_name:s.target.value})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("select",{className:"p-2 border rounded",value:a.category,onChange:s=>t({...a,category:s.target.value}),children:[e.jsx("option",{children:"General"}),e.jsx("option",{children:"GDPR"}),e.jsx("option",{children:"Brand Safety"}),e.jsx("option",{children:"Accessibility"})]}),e.jsxs("select",{className:"p-2 border rounded",value:a.severity,onChange:s=>t({...a,severity:s.target.value}),children:[e.jsx("option",{children:"High"}),e.jsx("option",{children:"Medium"}),e.jsx("option",{children:"Low"})]})]}),e.jsx("textarea",{placeholder:"Description",className:"w-full p-2 border rounded h-24",value:a.description,onChange:s=>t({...a,description:s.target.value})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{onClick:f,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Save Rule"})})]})})]})};export{k as default};
